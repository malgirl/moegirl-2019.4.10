{"parse":{"title":"MediaWiki:Gadget-heimu-toggle.js","pageid":133295,"wikitext":{"*":"// <pre>\n(function() {\n    function heimu_toggle() {\n        if (!$('.heimu, .colormu')[0] || $('#heimu_toggle')[0]) return;\n        $(\".colormu\").each(function() {\n            this.dataset.backgroundColor = $(this).css(\"background-color\");\n        });\n        var body = document.body,\n            html = document.documentElement;\n        var innerWidth = window.innerWidth;\n        var scrollbarWidth;\n        switch (\"scroll\") {\n            case getComputedStyle(body).overflowY:\n                scrollbarWidth = innerWidth - body.clientWidth;\n                break;\n            case getComputedStyle(html).overflowY:\n                scrollbarWidth = innerWidth - html.clientWidth;\n                break;\n            default:\n                var backup = body.style.overflowY;\n                body.style.overflowY = \"scroll\";\n                scrollbarWidth = innerWidth - body.clientWidth;\n                body.style.overflowY = backup;\n        }\n        var btn = $('<div/>', {\n            id: 'heimu_toggle',\n            text: '\u534a\u9690\u9ed1\u5e55',\n            css: {\n                'user-select': 'none',\n            },\n        }).appendTo(document.body).on('click', function() {\n            if ($('body.heimu_toggle_on')[0]) $(this).text('\u534a\u9690\u9ed1\u5e55');\n            else $(this).text('\u9690\u85cf\u9ed1\u5e55');\n            $(document.body).toggleClass('heimu_toggle_on');\n            $(\".colormu\").each(function() {\n                if ($(this).hasClass(\"colormu_toggle_on\")) {\n                    $(this).removeClass(\"colormu_toggle_on\");\n                    $(this).css(\"background-color\", this.dataset.backgroundColor);\n                } else {\n                    $(this).addClass(\"colormu_toggle_on\");\n                    $(this).css(\"background-color\", this.dataset.backgroundColor.replace(\"rgb\", \"rgba\").replace(\")\", \", .17)\"));\n                }\n            });\n        });\n        if (scrollbarWidth === 0) {\n            btn.css(\"right\", \"20px\"); // \u4fee\u590d\u65b0\u7248 Chrome \u7684\u81ea\u52a8\u9690\u85cf\u5f0f\u6eda\u52a8\u6761\u5bfc\u81f4\u7684\u6309\u94ae\u88ab\u8986\u76d6 chrome://flags/#overlay-scrollbars\n        }\n        if ($('.backToTop')[0]) $(window).on('scroll', function() {\n            $(document).scrollTop() > 0 ? btn.css('bottom', '193px') : btn.css('bottom', '100px');\n        }).scroll();\n        if (mw.config.get('AnnToolsHeimuToggleDefaultOn')) btn.click();\n        else mw.config.set('AnnToolsHeimuToggleDefaultOn', true);\n    }\n    setInterval(heimu_toggle, 3000);\n})();\n// </pre>"}}}