{"parse":{"title":"Widget:SortSubpageList","pageid":137339,"wikitext":{"*":"<includeonly><script>\nwindow.RLQ = window.RLQ || [];\nwindow.RLQ.push(function() {\n    var sort = (function() {\n        var chinesenumSort = (function() {\n            var normalizationList = {\n                \"\u4e00\": '1',\n                \"\u4e8c\": '2',\n                \"\u4e09\": '3',\n                \"\u56db\": '4',\n                \"\u4e94\": '5',\n                \"\u516d\": '6',\n                \"\u4e03\": '7',\n                \"\u516b\": '8',\n                \"\u4e5d\": '9'\n            };\n\n            function alphanum(a, b) {\n                function chunkify(t) {\n                    var tz = new Array();\n                    var x = 0,\n                        y = -1,\n                        n = 0,\n                        i, j;\n\n                    while (i = (j = t.charAt(x++)).charCodeAt(0)) {\n                        var m = (i == 46 || (i >= 48 && i <= 57));\n                        if (m !== n) {\n                            tz[++y] = \"\";\n                            n = m;\n                        }\n                        tz[y] += j;\n                    }\n                    return tz;\n                }\n\n                var aa = chunkify(a);\n                var bb = chunkify(b);\n\n                for (x = 0; aa[x] && bb[x]; x++) {\n                    if (aa[x] !== bb[x]) {\n                        var c = Number(aa[x]),\n                            d = Number(bb[x]);\n                        if (c == aa[x] && d == bb[x]) {\n                            return c - d;\n                        } else return (aa[x] > bb[x]) ? 1 : -1;\n                    }\n                }\n                return aa.length - bb.length;\n            }\n\n            function chineseNorm(title) {\n                title = title.replace(/([\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d])\u5341([\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d])/g, '$1$2').replace(/\u5341(?=[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d])/g, '1').replace(/\u5341/g, '10');\n                title = title.replace(/[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]/g, function(c) {\n                    return normalizationList[c];\n                });\n                return title;\n            }\n\n            return function chinesenumSort(a, b) {\n                var na = chineseNorm(a);\n                var nb = chineseNorm(b);\n                return alphanum(na, nb);\n            }\n        })();\n        var proposalSort = (function() {\n            var methods = ['setFullYear', 'setMonth', 'setDate'];\n\n            function parse(text) {\n                var date = new Date(0);\n                if (!text) {\n                    return -1;\n                }\n                var match = Array.from(text.match(/\\((\\d{4}\\.\\d{2}\\.\\d{2})\\)/));\n                if (!match[1]) {\n                    return -1\n                }\n                match[1].split('.').forEach(function(v, i) {\n                    date[methods[i]](v);\n                });\n                return date.getTime();\n            }\n            return function proposalSort(a, b) {\n                return parse(a) - parse(b);\n            }\n        })();\n\n        return function sort(a, b, t) {\n            switch (t) {\n                case \"chinesenum\":\n                    return chinesenumSort(a, b);\n                case \"proposal\":\n                    return proposalSort(a, b);\n                default:\n                    throw new ReferenceError('Widget:SortSubpageList: Type is not defined');\n            }\n        };\n    })();\n\n    $('.subpagelist').each(function(_, table) {\n        var $table = $(table);\n        var config = $table.find('.subpagelistConfig')[0];\n        if (!config || !config.dataset || !config.dataset.sort) return;\n        var $list = $table.find('.mw-prefixindex-list');\n        var list = $list.find('li').toArray();\n        list.sort(function(a, b) {\n            return sort($(a).text(), $(b).text(), config.dataset.sort);\n        });\n        list.forEach(function(li) {\n            $list.append(li);\n        });\n    });\n});\n</script></includeonly><noinclude>\n\u7528\u81ea\u5b9a\u4e49\u65b9\u5f0f\u6392\u5e8fSubpagelist\u3002\u5e94\u84dd\u9171\u7684\u8bf7\u6c42\u800c\u6dfb\u52a0\u3002\u8fd9\u4e2aWidget\u5e94\u5f53\u653e\u5728[[Widget:PrefixindexListTable]]\u4e4b\u524d\u3002\n\n\u652f\u6301\u7684\u6392\u5e8f\u65b9\u5f0f\n* chinesenum (\u9ed8\u8ba4) \u8be5\u65b9\u5f0f\u5c06\u4e2d\u6587\u6570\u5b57\u66ff\u6362\u6210\u963f\u62c9\u4f2f\u6570\u5b57\u4ee5\u540e\u8fdb\u884c\u6392\u5e8f\u3002\n\n\u4f5c\u8005\uff1a[[User:Nbdd0121|XYZ\u6307\u793a\u7269]]\n</noinclude>"}}}