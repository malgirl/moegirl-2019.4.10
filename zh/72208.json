{"parse":{"title":"User:Imbushuo/MediaWikiLint.js","pageid":222201,"wikitext":{"*":"var MwMonacoExtension;(function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i,r,u){this.isNoOpRegion=n;this.depth=t;this.lastOpenSection=i;this.beginLine=r?r:0;this.beginColumn=u?u:0}return n}();n.ControlBlockEnvironment=t})(t=n.Shared||(n.Shared={}))})(t=n.LanguageServices||(n.LanguageServices={}))})(MwMonacoExtension||(MwMonacoExtension={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i){this.success=n;this.index=t;this.length=i}return n.convertToMatch=function(t){if(t&&t.length>0){var i=t[0];return new n(!0,t.index,i.length)}return new n(!1,0,0)},n}();n.Match=t})(t=n.Shared||(n.Shared={}))})(t=n.LanguageServices||(n.LanguageServices={}))}(MwMonacoExtension||(MwMonacoExtension={})),function(n){var t;(function(t){var i=n.LanguageServices.Shared,r=function(){function n(n){var t=this;if(n){this.m_editorModel=n.getModel();n.onDidChangeModelContent(function(){clearTimeout(t.m_hTimer);t.m_hTimer=setTimeout(function(){return t.validate()},500)})}else throw new Error(\"Arg_ArgumentNullException\");this.m_lastPopBlk=null;this.m_stCtrlBlkEnv=[];this.m_validationMarkups=[];this.validate()}return Object.defineProperty(n.prototype,\"currentState\",{get:function(){return this.m_stCtrlBlkEnv?this.m_stCtrlBlkEnv[this.m_stCtrlBlkEnv.length-1]:null},enumerable:!0,configurable:!0}),n.prototype.validate=function(){var r=new i.ControlBlockEnvironment(!1,0),n,t;for(monaco.editor.setModelMarkers(this.m_editorModel,\"LinkLinter\",[]),this.m_validationMarkups=[],this.m_stCtrlBlkEnv=[],this.m_lastPopBlk=null,this.m_stCtrlBlkEnv.push(r),n=1;n<=this.m_editorModel.getLineCount();n++)(t=this.m_editorModel.getLineContent(n),t)&&(this.validateMatchInternal(t,n,0),this.currentState.lastOpenSection==4&&(this.m_validationMarkups.push({code:\"MW1004\",message:\"Link reference block is not closed.\",startLineNumber:this.currentState.beginLine,endLineNumber:this.currentState.beginLine,startColumn:this.currentState.beginColumn-1,endColumn:t.length+1,severity:monaco.Severity.Error}),this.m_stCtrlBlkEnv.pop()));monaco.editor.setModelMarkers(this.m_editorModel,\"LinkLinter\",this.m_validationMarkups)},n.prototype.validateMatchInternal=function(t,r,u){var s=this.currentState,e,p,c,f,h;if(s.isNoOpRegion){e=null;switch(s.lastOpenSection){case 2:e=t.match(n.g_regExpNoOpNoWikiSectionEndIdentifier);break;case 1:e=t.match(n.g_regExpNoOpPreFormattedBlkEndIdentifier)}e&&e.length>0&&(p=e[0],c=e.index+p.length,this.m_lastPopBlk=this.m_stCtrlBlkEnv.pop(),this.validateMatchInternal(t.substring(c),r,c))}else{var l=i.Match.convertToMatch(t.match(n.g_regExpNoOpNoWikiSectionBeginIdentifier)),a=i.Match.convertToMatch(t.match(n.g_regExpNoOpPreFormattedBlkBeginIdentifier)),v=i.Match.convertToMatch(t.match(n.g_regExpLinkBlkBeginIdentifier)),y=i.Match.convertToMatch(t.match(n.g_regExpLinkBlkEndIdentifier)),o=[];if(l.success&&o.push([l.index,l,2]),a.success&&o.push([a.index,a,1]),v.success&&o.push([v.index,v,4]),y.success&&o.push([y.index,y,5]),o.sort(function(n,t){return n[0]-t[0]}),o.length<1)return;f=o[0];h=null;switch(f[2]){case 2:case 1:h=new i.ControlBlockEnvironment(!0,s.depth+1,f[2],r,f[1].index+f[1].length+u);break;case 4:if(s.lastOpenSection==4){this.m_validationMarkups.push({severity:monaco.Severity.Error,startLineNumber:r,startColumn:f[1].index+1,endLineNumber:r,endColumn:f[1].index+f[1].length+1,message:\"Cannot include nested link.\",code:\"MW1005\"});return}h=new i.ControlBlockEnvironment(!1,s.depth+1,f[2],r,f[1].index+f[1].length+u);break;case 5:s.lastOpenSection==4&&(this.m_lastPopBlk=this.m_stCtrlBlkEnv.pop())}h&&this.m_stCtrlBlkEnv.push(h);this.validateMatchInternal(t.substring(f[1].index+f[1].length),r,f[1].index+f[1].length+u)}},n.prototype.dispose=function(){clearTimeout(this.m_hTimer);this.m_editorModel=null},n}();r.g_regExpNoOpNoWikiSectionBeginIdentifier=/<nowiki\\s*>/;r.g_regExpNoOpPreFormattedBlkBeginIdentifier=/<pre\\s*>/;r.g_regExpNoOpNoWikiSectionEndIdentifier=/<\\/nowiki\\s*>/;r.g_regExpNoOpPreFormattedBlkEndIdentifier=/<\\/pre\\s*>/;r.g_regExpLinkBlkBeginIdentifier=/\\[\\[/;r.g_regExpLinkBlkEndIdentifier=/\\]\\]/;t.LinkLinter=r})(t=n.LanguageServices||(n.LanguageServices={}))}(MwMonacoExtension||(MwMonacoExtension={}));\n//# sourceMappingURL=LinkLinter.min.js.map"}}}