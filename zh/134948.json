{"parse":{"title":"\u6a21\u5757:Dictionary","pageid":307960,"wikitext":{"*":"local dictionary = {}\n\nfunction dictionary.create(keycomparer, dic)\n\tlocal pairs = {}\n\tlocal comparer\n\tif dic == nil then\n\t\tcomparer = keycomparer or function(k1, k2) return k1 == k2 end\n\telse\n\t\tcomparer = keycomparer or dic.comparer\n\t\tfor i, pair in ipairs(dic.keyvaluepairs) do\n\t\t\ttable.insert(pairs, { key = pair.key, value = pair.value })\n\t\tend\n\tend\n\tlocal prototype = { comparer = comparer, keyvaluepairs = pairs }\n\tprototype.add = dictionary.add\n\tprototype.remove = dictionary.remove\n\tprototype.hasKey = dictionary.hasKey\n\tprototype.getValue = dictionary.getValue\n\tprototype.setValue = dictionary.setValue\n\treturn prototype\nend\n\nfunction dictionary.add(dic, key, value)\n\tif dic == nil then error(\"dic\u4e3a\u7a7a\u3002\") end\n\t\n\tif dic:hasKey(key) then\n\t\terror(\"\u5b57\u5178\u4e2d\u5df2\u7ecf\u5b58\u5728\u8fd9\u4e2a\u952e\u3002\")\n\tend\n\t\n\ttable.insert(dic.keyvaluepairs, { key = key, value = value })\nend\n\nfunction dictionary.remove(dic, key)\n\tif dic == nil then error(\"dic\u4e3a\u7a7a\u3002\") end\n\t\n\tlocal index\n\tfor i, pair in ipairs(dic.keyvaluepairs) do\n\t\tif dic.comparer(key, pair.key) then\n\t\t\tindex = i\n\t\t\tbreak\n\t\tend\n\tend\n\tif index ~= nil then table.remove(dic.keyvaluepairs, index) end\nend\n\nfunction dictionary.hasKey(dic, key)\n\tif dic == nil then error(\"dic\u4e3a\u7a7a\u3002\") end\n\t\n\tfor i, pair in ipairs(dic.keyvaluepairs) do\n\t\tif dic.comparer(key, pair.key) then\n\t\t\treturn true\n\t\tend\n\tend\n\treturn false\nend\n\nfunction dictionary.getValue(dic, key)\n\tif dic == nil then error(\"dic\u4e3a\u7a7a\u3002\") end\n\t\n\tfor i, pair in ipairs(dic.keyvaluepairs) do\n\t\tif dic.comparer(key, pair.key) then\n\t\t\treturn pair.value\n\t\tend\n\tend\n\terror(\"\u5b57\u5178\u4e2d\u627e\u4e0d\u5230\u8fd9\u4e2a\u952e\u3002\")\nend\n\nfunction dictionary.setValue(dic, key, value)\n\tif dic == nil then error(\"dic\u4e3a\u7a7a\u3002\") end\n\t\n\tlocal index\n\tfor i, pair in ipairs(dic.keyvaluepairs) do\n\t\tif dic.comparer(key, pair.key) then\n\t\t\tindex = i\n\t\t\tbreak\n\t\tend\n\tend\n\tif index == nil then\n\t\terror(\"\u5b57\u5178\u4e2d\u627e\u4e0d\u5230\u8fd9\u4e2a\u952e\u3002\")\n\telse\n\t\tdic.keyvaluepairs[index] = value\n\tend\nend\n\nreturn dictionary"}}}