{"parse":{"title":"\u6a21\u5757:Luaq/doc","pageid":308326,"wikitext":{"*":"LUAQ\u662fLua Query\u7684\u7f29\u5199\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u67e5\u8be2\u51fd\u6570\u8ba9\u4ee5Lua\u8868\uff08table\uff09\u4e3a\u4e3b\u7684\u6570\u636e\u6e90\u67e5\u8be2\u4ee3\u7801\u66f4\u52a0\u7b80\u4ecb\u3002\n\n== \u4f7f\u7528\u914d\u7f6e ==\n\u5728\u6a21\u5757\u4ee3\u7801\u4e2d\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a\n{{code|<nowiki>local luaq = require(\"Module:Luaq\")</nowiki>}}\n\u4e4b\u540e\u4fbf\u53ef\u4ee5\u901a\u8fc7<code>luaq</code>\u4f7f\u7528\u5404\u79cd\u67e5\u8be2\u51fd\u6570\u3002\n\n== \u4f7f\u7528 ==\n\u672c\u7ae0\u8282\u5c06\u4f1a\u4ecb\u7ecdLUAQ\u7684\u57fa\u672c\u6982\u5ff5\u3001\u67e5\u8be2\u51fd\u6570\u7684\u6587\u6863\u8bf4\u660e\u4ee5\u53ca\u4f7f\u7528\u65f6\u5fc5\u987b\u6216\u53ef\u9009\u7684\u6ce8\u610f\u4e8b\u9879\u3002\n\n\u82e5\u60a8\u60f3\u8981\u4e86\u89e3\u67e5\u8be2\u51fd\u6570\u7684\u5b9e\u73b0\u7ec6\u8282\uff0c\u6216\u8005\u5e0c\u671b\u4fee\u6539\u7ed3\u6784\u3001\u6dfb\u52a0\u66f4\u591a\u67e5\u8be2\u51fd\u6570\uff0c\u8bf7\u53c2\u9605[[#\u5f00\u53d1]]\u7ae0\u8282\u3002\n\n=== \u57fa\u672c\u6982\u5ff5 ===\n==== \u67e5\u8be2\u5bf9\u8c61 ====\n\u67e5\u8be2\u5bf9\u8c61\u662f\u7531LUAQ\u7684\u67e5\u8be2\u51fd\u6570\u6309\u7167\u67d0\u79cd\u89c4\u8303\u751f\u6210\u7684\u7279\u6b8a\u5bf9\u8c61\uff0c\u5b83\u7684\u672c\u8d28\u662fLua\u8868\uff0c\u4f46\u7531\u4e8e\u5176\u5185\u90e8\u7684\u7ed3\u6784\u5bf9\u4e8e\u4f7f\u7528\u8005\u6765\u8bf4\u662f\u672a\u77e5\u7684\uff0c\u6240\u4ee5\u65e0\u6cd5\u901a\u8fc7\u4e00\u822c\u7684\u624b\u6bb5\u83b7\u53d6\u5b83\u5305\u542b\u7684\u5185\u5bb9\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u4f7f\u7528\u8005'''\u6ca1\u6709\u5fc5\u8981'''\u5c1d\u8bd5\u53bb\u83b7\u53d6\u5b83\u5305\u542b\u7684\u5185\u5bb9\u3002\u56e0\u4e3a\u67e5\u8be2\u51fd\u6570[[#luaq.query|luaq.query]]\u4f1a\u5c55\u5f00\u67e5\u8be2\u5bf9\u8c61\u5e76\u5c06\u67e5\u8be2\u7ed3\u679c\u5305\u88c5\u4e3a\u4e00\u4e2aLua\u8868\uff0c\u6240\u4ee5\u53ea\u9700\u8c03\u7528[[#luaq.query|luaq.query]]\uff0c\u7136\u540e\u5bf9\u83b7\u53d6\u7684Lua\u8868\u8fdb\u884c\u5faa\u73af\u904d\u5386\u5373\u53ef\u3002\n\n==== \u5ef6\u8fdf\u67e5\u8be2 ====\n\u5ef6\u8fdf\u67e5\u8be2\u662fLUAQ\u7684\u91cd\u8981\u7279\u5f81\u4e4b\u4e00\uff0c\u5b83\u8868\u73b0\u4e3a\u2014\u2014\u5f53[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u88ab\u751f\u6210\u65f6\uff0c\u67e5\u8be2\u5bf9\u8c61\u5e76\u4e0d\u4f1a\u7acb\u5373\u5c55\u5f00\u3002\u552f\u6709\u8c03\u7528\u67d0\u4e9b\u67e5\u8be2\u51fd\u6570\u65f6\uff0c\u67e5\u8be2\u5bf9\u8c61\u624d\u4f1a\u88ab\u8ba1\u7b97\uff0c\u5e76\u8fd4\u56de\u67e5\u8be2\u7ed3\u679c\u3002\n\n\u5728\u201c[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u88ab\u751f\u6210\u65f6\u201d\u548c\u201c\u8c03\u7528\u7acb\u5373\u5c55\u5f00\u67e5\u8be2\u5bf9\u8c61\u7684\u51fd\u6570\u201d\u4e4b\u95f4\uff0c\u6539\u53d8\u4f5c\u4e3a\u6570\u636e\u6e90\u7684Lua\u8868\u5185\u5bb9\u5c06\u5bf9\u6700\u7ec8\u67e5\u8be2\u7ed3\u679c\u9020\u6210\u5f71\u54cd\u3002\n\n\u5728[[#\u67e5\u8be2\u51fd\u6570]]\u7ae0\u8282\u4e2d\uff0c\u4f1a\u7acb\u5373\u5c55\u5f00\u67e5\u8be2\u5bf9\u8c61\u7684\u51fd\u6570\u5c06\u6ce8\u6709\u8bf4\u660e\u3002\n\n=== \u67e5\u8be2\u51fd\u6570\u8c03\u7528\u683c\u5f0f ===\n\u4e3a\u4e86\u4f7f\u4ee3\u7801\u66f4\u52a0\u76f4\u89c2\u7b80\u6d01\uff0cLUAQ\u5728Lua\u51fd\u6570\u8c03\u7528\u8bed\u6cd5\u7cd6\u7684\u57fa\u7840\u4e0a\u652f\u6301\u4e86\u66f4\u7b80\u6d01\u7684\u5199\u6cd5\u3002'''\u4ee5\u4e0b\u4e24\u79cd\u5199\u6cd5\u662f\u7b49\u4ef7\u7684\uff1a'''\n;\u51fd\u6570\uff1a\n<code>luaq.''<\u67e5\u8be2\u51fd\u6570\u540d\u79f0>''('''''\u67e5\u8be2\u5bf9\u8c61'''''[, ''\u53c2\u65701''[, ''\u53c2\u65702''[..., ''\u53c2\u6570n'']]])</code>\n;\u8bed\u6cd5\u7cd6\uff1a\n<code>'''''\u67e5\u8be2\u5bf9\u8c61''''':''<\u67e5\u8be2\u51fd\u6570\u540d\u79f0>''([, ''\u53c2\u65701''[, ''\u53c2\u65702''[..., ''\u53c2\u6570n'']]])</code>\n\n\u5f53\u60a8\u4f7f\u7528\u4e86\u8bed\u6cd5\u7cd6\u8c03\u7528\u5f62\u5f0f\uff0c\u5e76\u4e14\u9047\u5230\u4e86\u83ab\u540d\u5176\u5999\u7684\u201c<code>bad argument #1 to '...' (table expected, got ...)</code>\u201d\u62a5\u9519\uff0c\u4e0d\u59a8\u68c0\u67e5\u4e00\u4e0b\u662f\u5426\u5c06<code>:</code>\u9519\u5199\u6210\u4e86<code>.</code>\u3002\n\n=== \u67e5\u8be2\u51fd\u6570 ===\n==== luaq.query ====\n<code>luaq.query('''''query''''')</code>\n\n\u5c55\u5f00\u4e00\u4e2a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n;''\u8fd9\u4e2a\u51fd\u6570\u5c06\u7acb\u5373\u5c55\u5f00\u67e5\u8be2\u5bf9\u8c61\uff0c\u5e76\u5c06\u67e5\u8be2\u7ed3\u679c\u5305\u88c5\u4e3a\u4e00\u4e2aLua\u8868\u8fd4\u56de\u3002''\n;\u53c2\u6570\uff1a\n:*<code>query</code>\uff1a\u8981\u5c55\u5f00\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n;\u8fd4\u56de\uff1a\n:\u4e00\u4e2aLua\u8868\u3002\n\n==== luaq.asQuery ====\n<code>luaq.asQuery(''t'')</code>\n\n\u5c06\u4e00\u4e2aLua\u8868\u5305\u88c5\u4e3a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n;''\u5f53\u53c2\u6570<code>t</code>\u4e0d\u662f\u67e5\u8be2\u5bf9\u8c61\u65f6\uff0c\u5c1d\u8bd5\u4f7f\u7528\u8bed\u6cd5\u7cd6<code>t:asQuery()</code>\u8c03\u7528\u53ef\u80fd\u4f1a\u5f15\u53d1\u9519\u8bef\u3002''\n;\u53c2\u6570\uff1a\n:*<code>t</code>\uff1a\u4e00\u4e2aLua\u8868\u3002\n;\u8fd4\u56de\uff1a\n:\u4e00\u4e2a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n::\u82e5\u53c2\u6570<code>t</code>\u4e3a\u4e00\u4e2a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u65f6\uff0c\u51fd\u6570\u5c06\u4f1a\u8fd4\u56de<code>t</code>\u81ea\u8eab\u3002\n::\u5426\u5219\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5305\u88c5\u4e86<code>t</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a\u9879\u5747\u4e3a\u4e00\u4e2aLua\u8868\uff0c\u5305\u542b\u5b57\u6bb5<code>key</code>\u548c<code>value</code>\uff0c\u5206\u522b\u5bf9\u5e94\u4f7f\u7528[//www.mediawiki.org/wiki/Extension:Scribunto/Lua_reference_manual#pairs pairs]\u5bf9Lua\u8868\u8fdb\u884c\u5faa\u73af\u904d\u5386\u65f6\u8fd4\u56de\u7684\u952e\u548c\u503c\u3002\n;\u9519\u8bef\uff1a\n#<code>bad argument #1 to 'asQuery' (table expected, got ...)</code>\uff1a\u5f53\u53c2\u6570<code>t</code>\u7684\u503c\u4e0d\u662f\u4e00\u4e2aLua\u8868\u7684\u65f6\u5019\u629b\u51fa\u6b64\u9519\u8bef\u3002\n;\u793a\u4f8b\uff1a\n*\u4ee3\u7801\uff1a\n{{code|<nowiki>local t = { 5, 4, 3, str = \"string\" , 2, 1}\nlocal q = luaq.asQuery(t)\nlocal r = q:query()\n\nprint(\"pairs(t):\")\nfor i, v in pairs(t) do\n    print(i..\"\\t\"..v)\nend\n\nprint()\nprint(\"ipairs(r):\")\nfor i, pair in ipairs(r) do\n    print(i..\"\\t\"..pair.key..\"\\t\"..pair.value)\nend</nowiki>}}\n*\u7ed3\u679c\uff1a\n<pre>\npairs(t):\n1       5\n2       4\n3       3\n4       2\n5       1\nstr     string\n\nipairs(r):\n1       1       5\n2       2       4\n3       3       3\n4       4       2\n5       5       1\n6       str     string\n</pre>\n\n==== luaq.select ====\n<code>luaq.select('''''query''''', ''func'')</code>\n\n\u5bf9\u65e7\u67e5\u8be2\u5bf9\u8c61\u7684\u6bcf\u4e00\u4e2a\u9879\u8fdb\u884c\u6307\u5b9a\u7684\u8f6c\u6362\uff0c\u5e76\u5c06\u7ed3\u679c\u5f62\u6210\u65b0\u7684\u67e5\u8be2\u5bf9\u8c61\u3002\n;\u53c2\u6570\uff1a\n:*<code>query</code>\uff1a\u4e00\u4e2a\u67e5\u8be2\u5bf9\u8c61\uff0c\u5176\u6bcf\u4e00\u4e2a\u9879\u5c06\u8981\u88ab\u8f6c\u6362\u3002\n:*<code>func</code>\uff1a\u5bf9<code>query</code>\u7684\u6bcf\u4e00\u4e2a\u9879\u8fdb\u884c\u7684\u8f6c\u6362\u51fd\u6570\u3002\u8f6c\u6362\u51fd\u6570\u5c06\u4f1a\u63a5\u53d7\u5230\u4e24\u4e2a\u53c2\u6570\u503c\uff1a\n:**\u7b2c1\u4e2a\u53c2\u6570\u503c\uff1a<code>query</code>\u7684\u5f53\u524d\u9879\u3002\n:**\u7b2c2\u4e2a\u53c2\u6570\u503c\uff1a\u4ece\u5f00\u59cb\u5230\u5f53\u524d\u7684\u7d22\u5f15\u3002\n;\u8fd4\u56de\uff1a\n:\u4e00\u4e2a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\u5b83\u7531\u8f6c\u6362\u540e\u7684\u9879\u7ec4\u6210\u3002\n;\u9519\u8bef\uff1a\n#<code>bad argument #2 to 'select' (table expected, got ...)</code>\uff1a\u5f53\u53c2\u6570<code>func</code>\u7684\u503c\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\u7684\u65f6\u5019\u629b\u51fa\u6b64\u9519\u8bef\u3002\n;\u793a\u4f8b1\uff1a\n\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8f6c\u6362\u51fd\u6570\u8fd4\u56de\u5f53\u524d\u9879\u7684\u503c\u7684\u7c7b\u578b\u3002\n*\u4ee3\u7801\uff1a\n{{code|<nowiki>local t = { 5, 4, 3, str = \"string\" , 2, 1}\nlocal q = luaq.asQuery(t)\n    :select(\n        function(pair)\n            return type(pair.value)\n        end\n    )\nlocal r = q:query()\n\nfor key, value in pairs(t) do\n    print(\"key = \"..key..\"\\tvalue = \"..value)\nend\n\nprint()\nprint(\"\u67e5\u8be2\u7ed3\u679c\uff1a\")\nfor i, v in ipairs(r) do\n    print(v)\nend</nowiki>}}\n*\u7ed3\u679c\uff1a\n<pre>\nkey = 1         value = 5\nkey = 2         value = 4\nkey = 3         value = 3\nkey = 4         value = 2\nkey = 5         value = 1\nkey = str       value = string\n\n\u67e5\u8be2\u7ed3\u679c\uff1a\nnumber\nnumber\nnumber\nnumber\nnumber\nstring\n</pre>\n;\u793a\u4f8b2\uff1a\n\u5728\u672c\u793a\u4f8b\u4e2d\uff0c[[#luaq.select|luaq.select]]\u51fd\u6570\u5224\u65ad\u5f53\u524d\u7d22\u5f15\u7684\u5947\u5076\u6027\u3002\u82e5\u7d22\u5f15\u4e3a\u5947\u6570\uff0c\u5219\u8fd4\u56de<code>key</code>\u5b57\u6bb5\u7684\u503c\uff1b\u82e5\u7d22\u5f15\u4e3a\u5076\u6570\uff0c\u5219\u8fd4\u56de<code>value</code>\u5b57\u6bb5\u7684\u503c\u3002\n*\u4ee3\u7801\uff1a\n{{code|<nowiki>local t = { 5, 4, 3, str = \"string\" , 2, 1}\nlocal q = luaq.asQuery(t)\n    :select(\n        function(pair, i)\n            if math.fmod(i, 2) == 1 then return pair.key\n            else return pair.value\n            end\n        end\n    )\nlocal r = q:query()\n\nfor key, value in pairs(t) do\n    print(\"key = \"..key..\"\\tvalue = \"..value)\nend\n\nprint()\nprint(\"\u67e5\u8be2\u7ed3\u679c\uff1a\")\nfor i, v in ipairs(r) do\n    print(v)\nend</nowiki>}}\n*\u7ed3\u679c\uff1a\n<pre>\nkey = 1         value = 5\nkey = 2         value = 4\nkey = 3         value = 3\nkey = 4         value = 2\nkey = 5         value = 1\nkey = str       value = string\n\n\u67e5\u8be2\u7ed3\u679c\uff1a\n1\n4\n3\n2\n5\nstring\n</pre>\n\n==== luaq.where ====\n<code>luaq.where('''''query''''', ''func'')</code>\n\n\u5bf9\u65e7\u67e5\u8be2\u5bf9\u8c61\u7684\u6bcf\u4e00\u4e2a\u9879\u8fdb\u884c\u6307\u5b9a\u7684\u7b5b\u9009\uff0c\u5e76\u5c06\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c\u5f62\u6210\u65b0\u7684\u67e5\u8be2\u5bf9\u8c61\u3002\n;\u53c2\u6570\uff1a\n:*<code>query</code>\uff1a\u4e00\u4e2a\u67e5\u8be2\u5bf9\u8c61\uff0c\u5176\u6bcf\u4e00\u4e2a\u9879\u5c06\u8981\u88ab\u7b5b\u9009\u3002\n:*<code>func</code>\uff1a\u5bf9<code>query</code>\u7684\u6bcf\u4e00\u4e2a\u9879\u8fdb\u884c\u68c0\u6d4b\u7684\u7b5b\u9009\u51fd\u6570\u3002\u68c0\u6d4b\u51fd\u6570\u5e94\u8fd4\u56de<code>true</code>\u6216<code>false</code>\uff0c\u4e14\u5c06\u4f1a\u63a5\u53d7\u5230\u4e24\u4e2a\u53c2\u6570\u503c\uff1a\n:**\u7b2c1\u4e2a\u53c2\u6570\u503c\uff1a<code>query</code>\u7684\u5f53\u524d\u9879\u3002\n:**\u7b2c2\u4e2a\u53c2\u6570\u503c\uff1a\u4ece\u5f00\u59cb\u5230\u5f53\u524d\u7684\u7d22\u5f15\u3002\n;\u8fd4\u56de\uff1a\n:\u4e00\u4e2a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\u5b83\u7531\u7b5b\u9009\u540e\u7684\u9879\u7ec4\u6210\u3002\n;\u9519\u8bef\uff1a\n#<code>bad argument #2 to 'where' (table expected, got ...)</code>\uff1a\u5f53\u53c2\u6570<code>func</code>\u7684\u503c\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570\u7684\u65f6\u5019\u629b\u51fa\u6b64\u9519\u8bef\u3002\n;\u793a\u4f8b\uff1a\n\u672c\u793a\u4f8b\u5728[[#luaq.select|luaq.select]]\u51fd\u6570\u7684'''\u793a\u4f8b1'''\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u7b5b\u9009\u3002[[#luaq.where|luaq.where]]\u51fd\u6570\u7684\u7b5b\u9009\u673a\u5236\u4e3a\u201c\u9879\u7684\u503c\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u201d\u6216\u201c\u9879\u7684\u503c\u4e0d\u5c0f\u4e8e3\u201d\u3002\n*\u4ee3\u7801\uff1a\n{{code|<nowiki>local t = { 5, 4, 3, str = \"string\" , 2, 1}\nlocal q = luaq.asQuery(t)\n    :select(\n        function(pair)\n            return type(pair.value)\n        end\n    )\n    :where(\n        function(e)\n            return type(e) == \"string\" or e >= 3\n        end\n    )\nlocal r = q:query()\n\nfor key, value in pairs(t) do\n    print(\"key = \"..key..\"\\tvalue = \"..value)\nend\n\nprint()\nprint(\"\u67e5\u8be2\u7ed3\u679c\uff1a\")\nfor i, v in ipairs(r) do\n    print(v)\nend</nowiki>}}\n*\u7ed3\u679c\uff1a\n<pre>\nkey = 1         value = 5\nkey = 2         value = 4\nkey = 3         value = 3\nkey = 4         value = 2\nkey = 5         value = 1\nkey = str       value = string\n\n\u67e5\u8be2\u7ed3\u679c\uff1a\n4\n3\n5\nstring\n</pre>\n\n==== luaq.count ====\n<code>luaq.count('''''query''''')</code>\n\n\u83b7\u53d6\u67e5\u8be2\u7ed3\u679c\u4e2d\u9879\u7684\u6570\u91cf\u3002\n;''\u8fd9\u4e2a\u51fd\u6570\u5c06\u7acb\u5373\u5c55\u5f00\u67e5\u8be2\u5bf9\u8c61\u3002''\n;\u53c2\u6570\uff1a\n:*<code>query</code>\uff1a\u4e00\u4e2a\u67e5\u8be2\u5bf9\u8c61\u3002\n;\u8fd4\u56de\uff1a\n:\u67e5\u8be2\u7ed3\u679c\u4e2d\u9879\u7684\u6570\u91cf\u3002\n;\u793a\u4f8b\uff1a\n\u672c\u793a\u4f8b\u540c\u65f6\u6f14\u793a\u4e86LUAQ\u7684[[#\u5ef6\u8fdf\u67e5\u8be2|\u5ef6\u8fdf\u67e5\u8be2]]\u3002\u8868\u4e2d\u542b\u67096\u5bf9\u503c\u952e\u5bf9\uff0c\u56e0\u6b64\u7b2c\u4e00\u6b21[[#luaq.count|luaq.count]]\u67e5\u8be2\u7684\u7ed3\u679c\u4e3a6\u3002\n\n\u5220\u53bb\u8868\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\u540e\uff0c\u5df2\u901a\u8fc7\u8c03\u7528[[#luaq.query|luaq.query]]\u5c55\u5f00\u67e5\u8be2\u7684\u53d8\u91cf<code>r</code>\uff0c\u5176\u5faa\u73af\u904d\u5386\u8f93\u51fa\u7684\u5185\u5bb9\u4e0d\u53d8\uff0c\u4f46\u7b2c\u4e8c\u6b21[[#luaq.count|luaq.count]]\u67e5\u8be2\u7684\u7ed3\u679c\u53d8\u4e3a5\u3002\n*\u4ee3\u7801\uff1a\n{{code|<nowiki>local t = { 5, 4, 3, str = \"string\" , 2, 1}\nlocal q = luaq.asQuery(t)\nlocal r = q:query()\nfor i, pair in ipairs(r) do\n\tprint(pair.key..\"\\t\"..pair.value)\nend\nprint(\"count() = \"..q:count())\n\nprint()\ntable.remove(t, 2) --\u5220\u53bb\u8868\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\nfor i, pair in ipairs(r) do\n\tprint(pair.key..\"\\t\"..pair.value)\nend\nprint(\"count() = \"..q:count())</nowiki>}}\n*\u7ed3\u679c\uff1a\n<pre>\n1       5\n2       4\n3       3\n4       2\n5       1\nstr     string\ncount() = 6\n\n1       5\n2       4\n3       3\n4       2\n5       1\nstr     string\ncount() = 5\n</pre>\n\n==== luaq.any ====\n\n==== luaq.all ====\n\n==== luaq.distinct ====\n\n==== luaq.groupBy ====\n\n== \u5f00\u53d1 ==\n\u672c\u7ae0\u8282\u5c06\u4f1a\u4ecb\u7ecdLUAQ\u7684\u5b9e\u73b0\u7ec6\u8282\u3001\u5f00\u53d1\u76f8\u5173\u7684\u6587\u6863\u8bf4\u660e\u7b49\u3002\n=== \u67e5\u8be2\u5bf9\u8c61\u4fdd\u7559\u5b57\u6bb5 ===\n[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u672c\u8d28\u662f\u4e00\u4e2aLua\u8868\u3002\u4e3a\u4e86\u5224\u65ad\u4e00\u4e2aLua\u8868\u662f\u5426\u4e3a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\uff0c\u540c\u65f6\u4e3a\u4e86\u5b9e\u73b0LUAQ\u6838\u5fc3\u529f\u80fd\uff0c\u4ee5\u4e0b\u7684\u5b57\u6bb5\u4e3a[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u7684\u4fdd\u7559\u5b57\u6bb5\uff0c\u8bf7\u5728\u5f00\u53d1\u4e2d'''\u4e0d\u8981\u5360\u7528'''\u8fd9\u4e9b\u5b57\u6bb5\uff1a\n{{columns-list|8|\n*<code>__getenumerator</code>\n}}\n\u9664\u6b64\u4e4b\u5916\uff0c\u5404\u4e2aLUAQ\u67e5\u8be2\u51fd\u6570\u751f\u6210\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u4e5f\u6709\u5404\u81ea\u7684\u4fdd\u7559\u5b57\u6bb5\uff0c\u8bf7\u5728\u5f00\u53d1\u4e2d\u907f\u514d\u5360\u7528\u3002\n\n\u5404\u67e5\u8be2\u51fd\u6570\u7684\u4fdd\u7559\u5b57\u6bb5\u5c06\u5206\u522b\u8bf4\u660e\u3002\n\n=== \u679a\u4e3e\u5668 ===\n\u5bf9\u6bcf\u4e00\u4e2a\u67e5\u8be2\u5bf9\u8c61\u8c03\u7528<code>__getenumerator</code>\u51fd\u6570\u5373\u53ef\u83b7\u5f97\u5176\u679a\u4e3e\u5668\u3002\n\n\u679a\u4e3e\u5668\u662f\u652f\u6301LUAQ[[#\u5ef6\u8fdf\u67e5\u8be2|\u5ef6\u8fdf\u67e5\u8be2]]\u7684\u57fa\u77f3\uff0c\u901a\u8fc7\u6539\u53d8\u5176\u5185\u90e8\u7684\u72b6\u6001\u53ef\u4ee5\u5b9e\u73b0\u5411\u524d\u3001\u5411\u540e\u67e5\u8be2\u7b49\u64cd\u4f5c\u3002\n\n\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u83b7\u53d6\u679a\u4e3e\u5668\u7684\u5bf9\u8c61\uff1a\n*;\u51fd\u6570\uff1a\n<code>'''''<\u67e5\u8be2\u5bf9\u8c61>'''''.__getenumerator('''''<\u67e5\u8be2\u5bf9\u8c61>''''')</code>\n*;\u8bed\u6cd5\u7cd6\uff1a\n<code>'''''<\u67e5\u8be2\u5bf9\u8c61>''''':__getenumerator()</code>\n==== \u679a\u4e3e\u5668\u5b57\u6bb5 ====\n\u679a\u4e3e\u5668\u662f\u4e00\u4e2aLua\u8868\uff0c\u4e3a\u4e86\u6b63\u5e38\u5de5\u4f5c\uff0c\u5b83'''\u5fc5\u987b'''\u5177\u6709\u4ee5\u4e0b\u5b57\u6bb5\uff1a\n*<code>current</code>\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3a\u51fd\u6570\uff0c\u7528\u4ee5\u83b7\u53d6\u5f53\u524d\u67e5\u8be2\u7684\u9879\u3002\n*;\u8c03\u7528\uff1a\n**'''\u51fd\u6570'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''.current('''''self''''', ''query'')</code>\n**'''\u8bed\u6cd5\u7cd6'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>''''':current(''query'')</code>\n*;\u53c2\u6570\uff1a\n*:<code>self</code>\uff1a\u5373<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u672c\u8eab\uff0c\u7528\u4ee5\u652f\u6301\u8bed\u6cd5\u7cd6\u8c03\u7528\u3002\n*:<code>query</code>\uff1a\u5305\u542b<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n*;\u8fd4\u56de\uff1a\n*:\u5f53\u524d\u67e5\u8be2\u7684\u9879\u3002\n*<code>moveLast</code>\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3a\u8fd4\u56de\u503c\u4e3a<code>true</code>\u6216<code>false</code>\u51fd\u6570\uff0c\u7528\u4ee5\u5c06[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u72b6\u6001\u5411\u540e\u56de\u9000\u4e00\u6b21\u3002\n*;\u8c03\u7528\uff1a\n**'''\u51fd\u6570'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''.moveLast('''''self''''', ''query'')</code>\n**'''\u8bed\u6cd5\u7cd6'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>''''':moveLast(''query'')</code>\n*;\u53c2\u6570\uff1a\n*:<code>self</code>\uff1a\u5373<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u672c\u8eab\uff0c\u7528\u4ee5\u652f\u6301\u8bed\u6cd5\u7cd6\u8c03\u7528\u3002\n*:<code>query</code>\uff1a\u5305\u542b<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n*;\u8fd4\u56de\uff1a\n*:\u4e00\u4e2a\u503c\uff0c\u6307\u793a\u56de\u9000\u64cd\u4f5c\u662f\u5426\u6210\u529f\u3002\n*<code>moveNext</code>\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3a\u8fd4\u56de\u503c\u4e3a<code>true</code>\u6216<code>false</code>\u51fd\u6570\uff0c\u7528\u4ee5\u5c06[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u72b6\u6001\u5411\u524d\u524d\u8fdb\u4e00\u6b21\u3002\n*;\u8c03\u7528\uff1a\n**'''\u51fd\u6570'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''.moveNext('''''self''''', ''query'')</code>\n**'''\u8bed\u6cd5\u7cd6'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>''''':moveNext(''query'')</code>\n*;\u53c2\u6570\uff1a\n*:<code>self</code>\uff1a\u5373<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u672c\u8eab\uff0c\u7528\u4ee5\u652f\u6301\u8bed\u6cd5\u7cd6\u8c03\u7528\u3002\n*:<code>query</code>\uff1a\u5305\u542b<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n*;\u8fd4\u56de\uff1a\n*:\u4e00\u4e2a\u503c\uff0c\u6307\u793a\u524d\u8fdb\u64cd\u4f5c\u662f\u5426\u6210\u529f\u3002\n*<code>saveState</code>\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3a\u51fd\u6570\uff0c\u7528\u4ee5\u83b7\u53d6[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u5f53\u524d\u72b6\u6001\u3002\n*;\u8c03\u7528\uff1a\n**'''\u51fd\u6570'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''.saveState('''''self''''', ''query'')</code>\n**'''\u8bed\u6cd5\u7cd6'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>''''':saveState(''query'')</code>\n*;\u53c2\u6570\uff1a\n*:<code>self</code>\uff1a\u5373<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u672c\u8eab\uff0c\u7528\u4ee5\u652f\u6301\u8bed\u6cd5\u7cd6\u8c03\u7528\u3002\n*:<code>query</code>\uff1a\u5305\u542b<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n*;\u8fd4\u56de\uff1a\n*:[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u5f53\u524d\u72b6\u6001\u3002\n*<code>resetState</code>\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4e3a\u51fd\u6570\uff0c\u7528\u4ee5\u8bbe\u7f6e[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u5f53\u524d\u72b6\u6001\u3002\n*;\u8c03\u7528\uff1a\n**'''\u51fd\u6570'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''.resetState('''''self''''', ''query'', ''state'')</code>\n**'''\u8bed\u6cd5\u7cd6'''\uff1a<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>''''':resetState(''query'', ''state'')</code>\n*;\u53c2\u6570\uff1a\n*:<code>self</code>\uff1a\u5373<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u672c\u8eab\uff0c\u7528\u4ee5\u652f\u6301\u8bed\u6cd5\u7cd6\u8c03\u7528\u3002\n*:<code>query</code>\uff1a\u5305\u542b<code>'''''<\u679a\u4e3e\u5668\u5bf9\u8c61>'''''</code>\u7684[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]\u3002\n*:<code>state</code>\uff1a\u8981\u8bbe\u7f6e\u7684[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u7684\u72b6\u6001\u3002\n==== \u679a\u4e3e\u5668\u5de5\u4f5c\u539f\u7406 ====\n#\u83b7\u53d6[[#\u67e5\u8be2\u5bf9\u8c61|\u67e5\u8be2\u5bf9\u8c61]]<code>query</code>\u3002\n#\u901a\u8fc7<code>query:__getenumerator()</code>\u83b7\u53d6[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]<code>enumerator</code>\u3002\u9664\u975e\u7279\u6b8a\u8bbe\u8ba1\uff0c\u4e00\u822c\u7684[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u7684\u521d\u59cb\u72b6\u6001\u4e3a\u8d77\u70b9\u3002\n#\u8c03\u7528<code>enumerator:moveNext(query)</code>\u5c06[[#\u679a\u4e3e\u5668|\u679a\u4e3e\u5668]]\u5185\u90e8\u72b6\u6001\u524d\u8fdb\u4e00\u6b21\uff0c\u82e5\u8fd4\u56de\u503c\u4e3atrue\uff0c\u5219\u7ee7\u7eed\u4e0b\u4e00\u6b65\u3002\n#\u8c03\u7528<code>enumerator:current(query)</code>\u83b7\u53d6\u5f53\u524d\u7684\u9879<code>current</code>\u3002\n#\u5bf9<code>current</code>\u8fdb\u884c\u540e\u7eed\u5904\u7406\u3002\n;\u793a\u4f8b\uff1a\n{{code|<nowiki>local query = luaq.asQuery({ 5, 4, 3, 2, 1 })\nlocal enumerator = query:__getenumerator()\nwhile enumerator:moveNext(query) do\n    local current = enumerator:current(query)\n    print(current.key..\"\\t\"..current.value)\nend</nowiki>}}\n;\u7ed3\u679c\uff1a\n<pre>\n1       5\n2       4\n3       3\n4       2\n5       1\n</pre>\n\n=== \u67e5\u8be2\u51fd\u6570\u5b9e\u73b0\u7ec6\u8282 ===\n==== \u5b9e\u73b0\u7ec6\u8282\uff1alinq.query ===="}}}