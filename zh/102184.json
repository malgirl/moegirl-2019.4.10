{"parse":{"title":"MediaWiki:Gadget-friendlyshared.js","pageid":164857,"wikitext":{"*":"//\u672cjs\u5f15\u81ea\u4e2d\u6587\u7ef4\u57fa\u767e\u79d1[[zhwiki:Special:Permalink/35984056]]\n// <pre>\n!function(){Twinkle.shared=function(){if(3===mw.config.get(\"wgNamespaceNumber\")&&Morebits.isIPAddress(mw.config.get(\"wgTitle\"))){var a=mw.config.get(\"wgTitle\").split(\"/\")[0].replace(/\\\"/,'\\\\\"');Twinkle.addPortletLink(function(){Twinkle.shared.callback(a)},\"Shared IP\",\"friendly-shared\",\"Shared IP tagging\")}},Twinkle.shared.callback=function(){var b,c,d,e,a=new Morebits.simpleWindow(600,420);a.setTitle(\"Shared IP address tagging\"),a.setScriptName(\"Twinkle\"),a.addFooterLink(\"Twinkle help\",\"WP:TW/DOC#shared\"),b=new Morebits.quickForm(Twinkle.shared.callback.evaluate),c=b.append({type:\"div\",id:\"sharedip-templatelist\",className:\"morebits-scrollbox\"}),c.append({type:\"header\",label:\"Shared IP address templates\"}),c.append({type:\"radio\",name:\"shared\",list:Twinkle.shared.standardList,event:function(a){Twinkle.shared.callback.change_shared(a),a.stopPropagation()}}),d=b.append({type:\"field\",label:'Fill in other details (optional) and click \"Submit\"'}),d.append({type:\"input\",name:\"organization\",label:\"IP address owner/operator\",disabled:!0,tooltip:\"You can optionally enter the name of the organization that owns/operates the IP address.  You can use wikimarkup if necessary.\"}),d.append({type:\"input\",name:\"host\",label:\"Host name (optional)\",disabled:!0,tooltip:\"The host name (for example, proxy.example.com) can be optionally entered here and will be linked by the template.\"}),d.append({type:\"input\",name:\"contact\",label:\"Contact information (only if requested)\",disabled:!0,tooltip:\"You can optionally enter some contact details for the organization.  Use this parameter only if the organization has specifically requested that it be added.  You can use wikimarkup if necessary.\"}),b.append({type:\"submit\"}),e=b.render(),a.setContent(e),a.display()},Twinkle.shared.standardList=[{label:\"{{Shared IP}}: standard shared IP address template\",value:\"Shared IP\",tooltip:\"IP user talk page template that shows helpful information to IP users and those wishing to warn, block or ban them\"},{label:\"{{Shared IP edu}}: shared IP address template modified for educational institutions\",value:\"Shared IP edu\"},{label:\"{{Shared IP corp}}: shared IP address template modified for businesses\",value:\"Shared IP corp\"},{label:\"{{Shared IP public}}: shared IP address template modified for public terminals\",value:\"Shared IP public\"},{label:\"{{Shared IP gov}}: shared IP address template modified for government agencies or facilities\",value:\"Shared IP gov\"},{label:\"{{Dynamic IP}}: shared IP address template modified for organizations with dynamic addressing\",value:\"Dynamic IP\"},{label:\"{{Static IP}}: shared IP address template modified for static IP addresses\",value:\"Static IP\"},{label:\"{{ISP}}: shared IP address template modified for ISP organizations (specifically proxies)\",value:\"ISP\"},{label:\"{{Mobile IP}}: shared IP address template modified for mobile phone companies and their customers\",value:\"Mobile IP\"},{label:\"{{Whois}}: template for IP addresses in need of monitoring, but unknown whether static, dynamic or shared\",value:\"Whois\"}],Twinkle.shared.callback.change_shared=function(a){a.target.form.contact.disabled=\"Shared IP edu\"!==a.target.value,a.target.form.organization.disabled=!1,a.target.form.host.disabled=\"Whois\"===a.target.value},Twinkle.shared.callbacks={main:function(a){var f,g,h,b=a.getCallbackParameters(),c=a.getPageText(),d=!1,e=\"{{\";for(f=0;f<Twinkle.shared.standardList.length;f++)g=new RegExp(\"(\\\\{\\\\{\"+Twinkle.shared.standardList[f].value+\"(\\\\||\\\\}\\\\}))\",\"im\"),g.exec(c)&&(Morebits.status.warn(\"Info\",\"Found {{\"+Twinkle.shared.standardList[f].value+\"}} on the user's talk page already...aborting\"),d=!0);d||(Morebits.status.info(\"Info\",\"Will add the shared IP address template to the top of the user's talk page.\"),e+=b.value+\"|\"+b.organization,\"Shared IP edu\"===b.value&&\"\"!==b.contact&&(e+=\"|\"+b.contact),\"Whois\"!==b.value&&\"\"!==b.host&&(e+=\"|host=\"+b.host),e+=\"}}\\n\\n\",h=\"Added {{[[Template:\"+b.value+\"|\"+b.value+\"]]}} template.\",a.setPageText(e+c),a.setEditSummary(h+Twinkle.getPref(\"summaryAd\")),a.setMinorEdit(Twinkle.getFriendlyPref(\"markSharedIPAsMinor\")),a.setCreateOption(\"recreate\"),a.save())}},Twinkle.shared.callback.evaluate=function(a){var c,d,e,b=a.target.getChecked(\"shared\");return!b||b.length<=0?(alert(\"You must select a shared IP address template to use!\"),void 0):(c=b[0],\"\"===a.target.organization.value?(alert(\"You must input an organization for the {{\"+c+\"}} template!\"),void 0):(d={value:c,organization:a.target.organization.value,host:a.target.host.value,contact:a.target.contact.value},Morebits.simpleWindow.setButtonsEnabled(!1),Morebits.status.init(a.target),Morebits.wiki.actionCompleted.redirect=mw.config.get(\"wgPageName\"),Morebits.wiki.actionCompleted.notice=\"Tagging complete, reloading talk page in a few seconds\",e=new Morebits.wiki.page(mw.config.get(\"wgPageName\"),\"User talk page modification\"),e.setFollowRedirect(!0),e.setCallbackParameters(d),e.load(Twinkle.shared.callbacks.main),void 0))}}(jQuery);\n// </pre>"}}}