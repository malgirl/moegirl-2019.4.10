{"parse":{"title":"Widget:Vote","pageid":182733,"wikitext":{"*":"<noinclude>\u4ec5\u4f9b{{tl|\u6295\u7968}}\u4f7f\u7528\u3002</noinclude><includeonly><!--{if !isset($wgVote) || !$wgVote}--><!--{assign var=\"wgVote\" value=true scope=\"global\"}-->\n<script>\nwindow.RLQ = window.RLQ || [];\nwindow.RLQ.push(function() {\n    mw.loader.using(\"moment\").then(function() {\n        var format = 'YYYY[\u5e74]MM[\u6708]DD[\u65e5 ]HH[:]MM';\n        $('.votebox').each(function() {\n            var self = $(this),\n                CSTTime = moment.unix(self.find('.UTCStartTime')[0].dataset.utcStartTime),\n                time = CSTTime.clone().utc(),\n                duration = +self.find('.UTCStartTime')[0].dataset.duration;\n            var endTime = time.clone().add(duration, 'd'),\n                CSTEndTime = CSTTime.clone().add(duration, 'd');\n            if (!time || !Number.isInteger(duration) || !CSTTime || !endTime || !time.isValid() || !CSTTime.isValid() || !endTime.isValid() || !CSTEndTime.isValid()) {\n                self.find('.loading').css('color', 'red').text('\u53d1\u751f\u4e86\u81f4\u547d\u9519\u8bef\uff01');\n                self.addClass('disabled');\n                return;\n            }\n            self.find('.startTimeInUTC').text(time.format(format));\n            self.find('.startTimeInCST').text(CSTTime.format(format));\n            self.find('.endTimeInUTC').text(endTime.format(format));\n            self.find('.endTimeInCST').text(CSTEndTime.format(format));\n            self.data('UTCEndTime', endTime.unix())\n            self.find('.loading').remove();\n            if (endTime.isAfter()) {\n                self.find('.voting').show();\n                self.find('.voted').hide();\n                self.find('.votingtime').text(endTime.fromNow(true));\n            } else {\n                self.find('.voted').show();\n                self.find('.voting').hide();\n            }\n        });\n        window.setInterval(function() {\n            $('.votebox:not(.disabled)').each(function() {\n                var self = $(this),\n                    time = moment.unix(self.data('UTCEndTime'));\n                if (!time || !time.isValid()) {\n                    self.find('.votingtime').css('color', 'red').text('\uff08\u53d1\u751f\u4e86\u81f4\u547d\u9519\u8bef\uff01\uff09');\n                    self.addClass('disabled');\n                    return;\n                }\n                if (time.isAfter()) {\n                    self.find('.voting').show();\n                    self.find('.voted').hide();\n                    self.find('.votingtime').text(time.fromNow(true));\n                } else {\n                    self.find('.voted').show();\n                    self.find('.voting').hide();\n                }\n            });\n        }, 1000);\n    });\n});\n</script>\n<!--{/if}--></includeonly>"}}}