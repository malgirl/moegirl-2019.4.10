{"parse":{"title":"\u6a21\u5757:Sandbox/\u6771\u6771\u541b/animeShow","pageid":281302,"wikitext":{"*":"local module = {}\n\nlocal getArgs = require('Module:Arguments').getArgs\n\nlocal randomSeed = 0\nfunction module._main(args)\n\tfunction random(count, min, max)\n\t\trandomSeed = randomSeed + 1\n\t\tmath.randomseed(tostring(os.time()):reverse():sub(1, 7)..randomSeed)\n\t\t\n\t\tif count == 1 then\n\t\t\treturn math.random(min, max)\t\n\t\tend\n\t\t\n\t\tlocal order = {}\n\t\tfunction test(num)\n\t\t\tfor i=1, #order do\n\t\t\t\tif num == order[i] then\n\t\t\t\t\treturn true\n\t\t\t\tend\n\t\t\tend\n\t\t\treturn false\n\t\tend\n\t\t\n\t\trepeat\n\t\t    local ran = math.random(min, max)\n\t\t\tif test(ran) == false then  \n\t\t\t\torder[#order + 1] = ran\n\t\t\tend\n\t\tuntil(#order == count)\n\t\t\n\t\treturn order\n\tend\n\t\n\tlocal data = args[1]\n\tlocal num = tonumber(args['num']) or 19 \n\tlocal anime = {}\n\tlocal iter = string.gmatch(data, '%[%[(.-)%]%]')\n\tfor v in iter do\n\t\tv = string.gsub(v, '<.->', '')\n\t\tlocal link = v\n\t\tlocal text = v\n\t\tif string.find(v, '%|') ~= nil then\n\t\t\tlink = string.gsub(v, '([^|]*)%|?([^|]*)', '%1')\n\t\t\ttext = string.gsub(v, '[^|]*%|?([^|]*)', '%1')\t    \t\t\n\t\tend\n\t\tif mw.ustring.find(text, '^[\u67e5\u8bba\u7f16]$') == nil then\n\t\t\tlocal r = random(1, 0, 255)\n\t\t\tlocal g = random(1, 0, 255)\n\t\t\tlocal b = random(1, 0, 255)\n\t\t\tlocal element = '[['..link..'|<span style=\"display:inline-block; color:rgb('..r..','..g..','..b..');\">'..text..'</span>]]'\n\t\t\tanime[#anime + 1] = element\n\t\tend\n\tend\n\t\n\tlocal set = {}\n\tlocal ran = random(num, 1, #anime)\n\tfor i=1, num do\n\t\tset[#set + 1] = anime[ran[i]]\t\n\tend\n\t\n\tlocal str = ''\n\tfor i=1, #set do\n\t\tstr = str..set[i]..'$'\n\tend\n\t\n\treturn str\nend\n\nfunction module.main(frame)\n\tlocal args = getArgs(frame)\n\treturn module._main(args)\nend\n\nreturn module"}}}