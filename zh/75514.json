{"parse":{"title":"User:\u68a6\u8776\u846c\u82b1/common.js","pageid":267414,"wikitext":{"*":"mw.loader.load('https://wikiplus-app.com/Main.js');\nmw.loader.load('//meta.wikimedia.org/w/index.php?title=User:Krinkle/RTRC.js&action=raw&ctype=text/javascript'); //RTRC\uff08\u6700\u8fd1\u66f4\u6539\u5b9e\u65f6\u66f4\u65b0\uff09\nmw.loader.load('https://zh.wikipedia.org/w/index.php?title=User:Bluedeck/serve/edit-count.js&action=raw&ctype=text/javascript'); //\u5728\u53f3\u4e0a\u89d2\u663e\u793a\u81ea\u5df1\u7684\u7f16\u8f91\u6b21\u6570\nmw.loader.load('http://meta.wikimedia.org/wiki/MediaWiki:Gadget-markblocked.js&action=raw&ctype=text/javascript'); //\u7528\u5220\u9664\u7ebf\u8868\u793a\u88ab\u5c01\u7981\u7684\u7528\u6237\nimportScriptURI('//en.wikipedia.org/w/index.php?title=User:Cacycle/wikEd.js&action=raw&ctype=text/javascript'); //wikED\n\n/**\n * \u53d6\u81ea\u4e2d\u6587\u7ef4\u57fa\u767e\u79d1 oldid=46107689\uff0c\u6709\u5220\u6539\n * \u4fee\u6539\uff1a\u68a6\u8776\u846c\u82b1\uff1b\u65e5\u671f\uff1a2018\u5e743\u670811\u65e5\n * MarkIPBE.js\n *\n * \u5728\u6700\u8fd1\u4fee\u6539\u3001\u76d1\u89c6\u5217\u8868\u3001\u6761\u76ee\u5386\u53f2\u8bb0\u5f55\u7b49\u4f4d\u7f6e\u4ee5\u7279\u6b8a\u683c\u5f0f\u663e\u793a\u6709\u7279\u6b8a\u6743\u9650\u7684\u7528\u6237\n * \u4fee\u6539\uff1a\u53d6\u6d88IPBE\u3001\u56de\u9000\u5458\u3001\u76d1\u7763\u5458\uff1b\u5de1\u67e5\u8c41\u514d\u6743\uff08autopatroll/autoreviewer\uff09\u6539\u540d\u4e3a\u4f18\u8d28\u7f16\u8f91\u8005\uff08goodeditor\uff09\uff1a\u5b9e\u9645\u4e0a\u662f\u539f\u6765\u7684\u540d\u5355\u5168\u90fd\u6e05\u6d17\u4e86\u7136\u540e\u6539\u4e86\u4e2a\u540d\u3002\n * \n */\n\n$(function () {\n    var markIPBE = function () {\n        var $users = $('a.mw-userlink:not(.mw-anonuserlink)');\n        var users = {};\n        $users.each(function (index, link) {\n            users[link.textContent] = true;\n        });\n\n        var queue1 = [];\n        var queue2 = [];\n        var i=0, n=0;\n        for (var user in users) {\n            queue1.push(user);\n            i++;\n            if (i === 50) {\n                queue2.push(queue1);\n                queue1 = [];\n                n++;\n                i = 0;\n            }\n        }\n        if (queue1.length > 0) {\n            queue2.push(queue1);\n            n++;\n        }\n\n        var sysoplist = [];\n        var bureaucratlist = [];\n        var culist = [];\n        var plist = [];\n        var alist = [];\n\n        var done = function () {\n            var j;\n            for (j=0; j<bureaucratlist.length; j++) {\n                $('a.mw-userlink[title=\"User:' + bureaucratlist[j] + '\"]').append('<sup style=\"color:black;\">\u653f</sup>');\n            }\n            for (j=0; j<culist.length; j++) {\n                $('a.mw-userlink[title=\"User:' + culist[j] + '\"]').append('<sup style=\"color:purple;\">\u67e5</sup>');\n            }\n            for (j=0; j<sysoplist.length; j++) {\n                $('a.mw-userlink[title=\"User:' + sysoplist[j] + '\"]').append('<sup style=\"color:orange;\">\u7ba1</sup>');\n            }\n            for (j=0; j<plist.length; j++) {\n                $('a.mw-userlink[title=\"User:' + plist[j] + '\"]').append('<sup style=\"color:blue;\">\u5de1</sup>');\n            }\n            for (j=0; j<alist.length; j++) {\n                $('a.mw-userlink[title=\"User:' + alist[j] + '\"]').append('<sup style=\"color:green;\">\u514d</sup>');\n            }\n        };\n\n        var process = function (data) {\n            var users;\n            if (data.query && data.query.users) {\n                users = data.query.users;\n            } else {\n                users = [];\n            }\n            for (var i=0; i<users.length; i++) {\n                var user = users[i];\n                if (user.groups) {\n                    if (user.groups.indexOf('bureaucrat') > -1) {\n                        bureaucratlist.push(user.name);\n                    }\n                    if (user.groups.indexOf('checkuser') > -1) {\n                        culist.push(user.name);\n                    }\n                    if (user.groups.indexOf('sysop') > -1) {\n                        sysoplist.push(user.name);\n                    }\n                    if (user.groups.indexOf('patroller') > -1) {\n                        plist.push(user.name);\n                    }\n                    if (user.groups.indexOf('goodeditor') > -1) {\n                        alist.push(user.name);\n                    }\n                }\n            }\n\n            n--;\n            if (n <= 0) {\n                done();\n            }\n        };\n\n        var api = new mw.Api();\n        for (var j=0; j<queue2.length; j++) {\n            api.get({\n                format: 'json',\n                action: 'query',\n                list: 'users',\n                usprop: 'groups',\n                ususers: queue2[j].join('|')\n            }).done(process);\n        }\n    };\n\n    markIPBE();\n});"}}}