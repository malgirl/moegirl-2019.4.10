{"parse":{"title":"Widget:TrueRandom","pageid":78727,"wikitext":{"*":"<noinclude>\n\u540d\u79f0\uff1a\u771f\u968f\u673a\u6570\u4ea7\u751f\u5668\n\n\u4f5c\u8005\uff1agrzhan\n\n\u7248\u6743\u534f\u5b9a\uff1a\u77e5\u8bc6\u5171\u4eab(Creative Commons) \u7f72\u540d-\u975e\u5546\u4e1a\u6027\u4f7f\u7528-\u76f8\u540c\u65b9\u5f0f\u5171\u4eab 3.0 \u534f\u8bae \uff08CC 3.0 BY-NC-SA\uff09\n\n\u53d1\u5e03\u65e5\u671f\uff1a2014\u5e744\u670814\u65e5\u7b2c\u4e00\u7248\u53d1\u5e03\n\n\u53d1\u5e03\u5730\u5740\uff1ahttp://zh.moegirl.org/Widget:TrueRandom\n\n\u6ce8\u610f\u4e8b\u9879\uff1a\u8f6c\u8f7d\u4fdd\u7559\u51fa\u5904\u94fe\u63a5\n\n\u4ecb\u7ecd\uff1a\u8fd9\u662f\u4f7f\u7528RANDOM.ORG\u63d0\u4f9b\u7684\u771f\u968f\u673a\u6570\u7684\u4ea7\u751f\u5668\uff0c\u76ee\u524d\u4e3b\u8981\u7528\u4e8e\u859b\u5b9a\u8c14\u7684\u80d6\u6b21\n\n\u9644\u6ce8\uff1a\u628aincludeonly\u6807\u7b7e\u5185\u7684\u4ee3\u7801\u590d\u5236\u5230Widget:TrueRandom\u9875\u9762\u4e2d\uff08\u542bincludeonly\u6807\u7b7e)\uff0c\u7136\u540e\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u63d2\u5165Widget\u3002\n\n\u4f7f\u7528\u65b9\u6cd5\uff1a <nowiki>{{#widget:TrueRandom|src1=\"\"|src2=\"\"|pid=\"\"}}</nowiki>\n\n== \u53c2\u6570 ==\n* '''src1''' \u548c '''src2''' - \u8981\u968f\u673a\u7684\u4e24\u4e2a\u5bf9\u8c61\uff0c\u4e3a\u56fe\u7247\u7684url\u5730\u5740\uff0c\u9ed8\u8ba4\u4e3a\u80d6\u6b21\u56fe- -\n* '''pid'''\u3000\u8be5\u63d2\u4ef6\u7684\u6807\u8bc6\u7b26\uff0c\u4e3a\u4e86\u907f\u514d\u5728\u540c\u4e2a\u9875\u9762\u591a\u6b21\u4f7f\u7528\u8be5\u63d2\u4ef6\u9020\u6210\u51b2\u7a81\n\n[[\u5206\u7c7b:\u63d2\u4ef6]]\n</noinclude>\n<includeonly>\n    <table class=\"pants_container\" id=\"truerandom_<!--{$pid|default:1|validate:int}-->\">\n    \t<th>\u70b9\u5f00\u6211\uff0c\u770b\u770b\u4f60\u7684\u8fd0\u6c14\u5982\u4f55[<input type=\"button\" class=\"button\" value=\"\u70b9\u51fb\"/>]</th>\n    \t<tr>\n    \t\t<td>\n\t\t\t\t<div class=\"pants\"><img src=\"<!--{$src1|default:'http://image-hosting.qiniudn.com/withpants.png'|validate:url}-->\" alt=\"\"></div>\n\t\t\t\t<div class=\"nopants\"><img src=\"<!--{$src2|default:'http://image-hosting.qiniudn.com/nopants.jpg'|validate:url}-->\" alt=\"\" ></div>\n\t\t\t\t<div class=\"wait\">\u8fd8\u5728\u52a0\u8f7d\u771f\u968f\u673a\u6570\u636e\uff0c\u8bf7\u7a0d\u7b49</div>\n\n\t\t\t</td>\n    \t</tr>\n    </table>\n\t\n\t<script>\n\n\t\t$(document).ready(function(){\n\t\t\tvar container = \"#truerandom_<!--{$pid|default:1|validate:int}-->\";\n\t\t\tconsole.log(container);\n\t\t\t$(container + ' .pants').hide();\n\t\t\t$(container + ' .nopants').hide();\n\t\t\t$(container + ' .wait').hide();\n\t\t\t$(container + ' .error').hide();\n\n\t\t\tvar pants_state = container + \" .pants\";\n\t\t\tvar state = false;\n\t\t\tvar req = {\n\t\t\t\t\"jsonrpc\":\"2.0\",\n\t\t\t\t\"method\":\"generateIntegers\",\n\t\t\t\t\"params\": {\n\t\t\t\t\t\"apiKey\":\"a3f6b524-9d01-46cf-8c20-b2ccec32d87ba\",\n\t\t\t\t\t\"n\":64,\n\t\t\t\t\t\"min\":0,\n\t\t\t\t\t\"max\":1,\n\t\t\t\t\t\"replacement\":true},\n\t\t\t\t\"id\":<!--{$pid|default:'1'|validate:int}-->\n\t\t\t};\n\n\t\t\tvar random_seq;\n\n\t\t\t$.post(\"https://api.random.org/json-rpc/1/invoke\",JSON.stringify(req), function(data,textStatus) {\n\t\t\t\tstate = true;\n\t\t\t\t$(container + ' .wait').hide();\n\t\t\t\t$(container + ' .error').empty();\n\n\t\t\t\trandom_seq = new Array();\n\n\t\t\t\tfunction pseudo_random(num) {\n\t\t\t\t\tfor (var i = 0; i<num;i++) {\n\t\t\t\t\t\tif (Math.random() < 0.5) {\n\t\t\t\t\t\t\trandom_seq.push(0);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trandom_seq.push(1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (textStatus != \"success\") {\n\t\t\t\t\tpseudo_random(64);\n\t\t\t\t\tconsole.log(\"Truerandom Widget Error: \" + textStatus);\n\t\t\t\t\treturn ;\n\t\t\t\t} \n\n\t\t\t\tif (data['error'] != null) {\n\t\t\t\t\tpseudo_random(64);\n\t\t\t\t\tconsole.log(\"Truerandom Widget Error: \" + JSON.stringify(data['error']));\n\t\t\t\t\treturn ;\n\t\t\t\t}\n\t\t\t\trandom_seq = data['result']['random']['data'];\n \n\t\t\t},'json');\n\n\t\t\tvar toggle_state = 0;\n\t\t\tvar arr_index = 0;\n\n\t\t\t$(container + \" .button\").click(function(){\n\t\t\t\tif (state) {\n\t\t\t\t\ttoggle_state = 1 - toggle_state\n\t\t\t\t\tif (toggle_state == 1) {\n\t\t\t\t\t\tif (random_seq != undefined) {\n\t\t\t\t\t\t\tvar arr_len = random_seq.length;\n\t\t\t\t\t\t\tvar p = random_seq[arr_index % arr_len];\n\t\t\t\t\t\t\tarr_index ++;\n\t\t\t\t\t\t\tif (p == 0) {\n\t\t\t\t\t\t\t\tpants_state = container + \" .pants\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpants_state = container + \" .nopants\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpants_state = container + \" .pants\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(pants_state).fadeIn();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(pants_state).fadeOut();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$(container + \" .wait\").show();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t</script>\n\n</includeonly>"}}}