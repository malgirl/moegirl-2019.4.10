{"parse":{"title":"Widget:Randompic","pageid":80312,"wikitext":{"*":"<noinclude>\n\u7531\u4e8e\u4f5c\u8005\u5bf9\u4e8e\u4f4e\u7248\u672c\u6d4f\u89c8\u5668\u7684\u6b67\u89c6 \u672c\u811a\u672c\u53ef\u80fd\u5728\u4f4e\u7248\u672c\u7684\u6d4f\u89c8\u5668\u4e0a\u4e0d\u8d77\u4f5c\u7528\n\n\u4f5c\u8005\uff1a\u59b9\u7a7a\u9171 2014.5.9 \u665a\n\n</noinclude>\n<includeonly>\n<script>\nwindow.RLQ.push(function() {\n    mw.loader.implement('widgetTabs', function() {\n        console.log('Running');\n        //\u7531\u4e8e\u4f5c\u8005\u5bf9\u4e8e\u4f4e\u7248\u672c\u6d4f\u89c8\u5668\u7684\u6b67\u89c6 \u672c\u811a\u672c\u53ef\u80fd\u5728\u4f4e\u7248\u672c\u7684\u6d4f\u89c8\u5668\u4e0a\u4e0d\u8d77\u4f5c\u7528\n        function getimageinfo(a) {\n            a = \"File:\" + a, $.ajax({\n                url: api,\n                type: \"GET\",\n                data: {\n                    action: \"query\",\n                    titles: a,\n                    prop: \"imageinfo\",\n                    iiprop: \"url\",\n                    format: \"json\"\n                },\n                dataType: \"json\",\n                success: function(a) {\n                    for (i in a.query.pages) id = i;\n                    a.query.pages[id].imageinfo[0].url ? (console.log(a.query.pages[id].imageinfo[0].url), $(\".randompic\").html('<img src=\"' + a.query.pages[id].imageinfo[0].url + '\"></img>')) : $(\".randompic\").html(\"\u73b0\u5728\u859b\u5b9a\u8c14\u5bb6\u7684\u732b\u4e0d\u5728\u5bb6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u8bd5\u5427\uff01\")\n                },\n                error: function() {\n                    $(\".randompic\").html(\"\u73b0\u5728\u859b\u5b9a\u8c14\u5bb6\u7684\u732b\u4e0d\u5728\u5bb6\uff0c\u4e00\u4f1a\u513f\u518d\u8bd5\u8bd5\u5427\uff01\")\n                }\n            })\n        }\n        api = location.origin + \"/api.php\", $(document).ready(function() {\n            $(\".randompic\").html(\"\u6b63\u5728\u4e3a\u60a8\u6a21\u62df\u859b\u5b9a\u8c14\u7684\u80d6\u6b21\u5b9e\u9a8c..\u8bf7\u7a0d\u7b49\"), picurl = Math.random() >= .5 ? getimageinfo(\"<!--{$pic1|escape:'html'}-->\") : getimageinfo(\"<!--{$pic2|escape:'html'}-->\")\n        });\n    });\n});\n//18294010.jpg\n//35621550.png\n</script>\n<div class=\"randompic\"></div>\n</includeonly>"}}}