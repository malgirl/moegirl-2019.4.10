{"parse":{"title":"Widget:Toc2Table","pageid":136758,"wikitext":{"*":"<noinclude>Only for {{tl|Toc2Table}}</noinclude><includeonly><!--{if !isset($wgToc2Table) || !$wgToc2Table}--><!--{assign var=\"wgToc2Table\" value=true scope=\"global\"}--><span id=\"notoc\"></span><style>\n.NOTOC {\n    display: none!important;\n}\n\n.NOTOC.show {\n    width: 100%;\n}\n\n#tocul {\n    -webkit-column-width: 250px;\n    -moz-column-width: 250px;\n    column-width: 250px;\n}\n\n#toc2Table td {\n    word-wrap: break-word;\n    word-break: break-all;\n    white-space: initial;\n}\n</style><script>\n/* global mw */\nwindow.RLQ = window.RLQ || [];\nwindow.RLQ.push(function() {\n    mw.loader.implement('widgetToc2Table', function() {\n        if (!$('#toc2TableSetting')[0]) return;\n        var setting = {\n                tableStyle: null,\n                listLength: 4,\n                title: '\u76ee\u5f55',\n                titleStyle: null,\n                tdStyle: null,\n                borderColor: undefined,\n                noNumber: null,\n                noIndex: null\n            },\n            dataset = $('#toc2TableSetting')[0].dataset,\n            $tocLine = $('#toc .toclevel-1'),\n            $tocTable = $('<table/>', {\n                id: 'toc2Table'\n            }),\n            styleFun = function(sS) {\n                if (!sS) return {\n                    'none': 'nothing' //anti jQuery.css check and make the chain call available\n                };\n                var array = sS.split(';'),\n                    o = {},\n                    i, l = array.length,\n                    t;\n                for (i = 0; i < l; i++) {\n                    if (!array[i]) continue;\n                    t = array[i].split(':');\n                    if (t.length != 2) continue;\n                    o[t[0].trim()] = t[1];\n                }\n                return o;\n            },\n            tocnumberLength, temp, index, noIndexArray;\n\n        //$.extend will overwrite dest value even if src value is empty\n        for (index in dataset) dataset[index] ? setting[index] = dataset[index] : '';\n        $('#toc2TableSetting').html() ? setting.title = $('#toc2TableSetting').html() : '';\n\n        //DOM work\n        if (setting.noIndex) {\n            noIndexArray = setting.noIndex.split(',').reverse();\n            $.each(noIndexArray, function(i, v) {\n                $tocLine.splice(v, 1);\n            });\n        }\n        $tocTable.append('<caption>' + setting.title + '</caption>');\n        $tocLine.each(function(index) {\n            if (index % setting.listLength == 0) $tocTable.append('<tr></tr>');\n            temp = $tocTable.find('tr:last').append('<td></td>').find('td:last').append($tocLine.eq(index).clone().children('a')).find('a');\n            if (!temp.find('.tocnumber')[0]) temp.prepend('<span class=\"tocnumber\">' + (index + 1) + '</span>');\n            tocnumberLength = ((index + 1) + '').length;\n        })\n        if ($('#toc2TableSetting').prevAll('h2')[0]) $('#toc2TableSetting').after($tocTable);\n        else $('#toc').after($tocTable);\n        $('#toc').remove();\n\n        //UI work\n        $tocTable.css('width', '100%') //                                     TableStyle: default width,\n            .css(styleFun(setting.tableStyle)) //                                         user style;\n            .find('caption').css(styleFun(setting.titleStyle)) //             TitleStyle: user style;\n            .end().find('td').css(styleFun(setting.tdStyle)); //              TdStyle:    user style;\n        $tocTable.css('border-collapse', 'collapse') //                       TableStyle: border collapse;\n            .find('tr:last').each(function() { //                             chain call: if the last line doesn't has enough tds, add to enough;\n                var i = setting.listLength - $(this).find('td').length;\n                while (i--) $(this).append('<td>&#32;</td>');\n            })\n            .end().find('td').css({\n                'border': '1px solid ' + setting.borderColor || '#a7d7f9', // TdStyle:    user style with default color(#a7d7f9).\n                'width': (100 / setting.listLength) + '%'\n            });\n\n        if (setting.noNumber == \"true\") $('.tocnumber').remove();\n        else $('.tocnumber').each(function() {\n            if ($(this).text().length == tocnumberLength) return;\n            temp = $(this).prepend('<span style=\"speak:none;visibility:hidden;color:transparent\"></span>').find('span');\n            while (tocnumberLength - $(this).text().length) temp.append('0');\n        });\n    });\n});\n</script><!--{/if}--></includeonly>"}}}